# 水晶ERP项目分享指南

## 🚨 为什么直接压缩整个项目文件夹会有问题？

当您直接压缩整个 `shuijing ERP` 文件夹时，会遇到以下问题：

### 1. 文件过大问题
- **node_modules** 文件夹包含数千个依赖文件，压缩后仍然很大（通常>100MB）
- **uploads** 文件夹包含所有上传的图片文件
- **coverage** 文件夹包含测试覆盖率报告
- **dist** 文件夹包含构建产物

### 2. 敏感信息泄露
- **.env** 文件包含数据库密码、API密钥等敏感信息
- **SSL证书文件** (.pem文件)
- **日志文件** 可能包含敏感操作记录

### 3. 平台兼容性问题
- **node_modules** 中的二进制文件可能不兼容不同操作系统
- 路径分隔符在Windows/Mac/Linux上不同

## ✅ 正确的项目分享方式

### 方式一：使用Git（推荐）

```bash
# 1. 初始化Git仓库（如果还没有）
git init

# 2. 添加所有源代码文件
git add .

# 3. 提交代码
git commit -m "初始项目提交"

# 4. 推送到GitHub/Gitee等代码托管平台
git remote add origin https://github.com/yourusername/shuijing-erp.git
git push -u origin main
```

**接收方操作：**
```bash
# 1. 克隆项目
git clone https://github.com/yourusername/shuijing-erp.git
cd shuijing-erp

# 2. 安装前端依赖
npm install

# 3. 安装后端依赖
cd backend
npm install

# 4. 配置环境变量（见下文）
# 5. 启动项目（见下文）
```

### 方式二：手动打包源代码

#### 需要包含的文件和文件夹：

```
✅ 必须包含：
├── src/                    # 前端源代码
├── backend/src/           # 后端源代码
├── backend/prisma/        # 数据库模型
├── .trae/documents/       # 项目文档
├── public/                # 静态资源
├── package.json           # 前端依赖配置
├── backend/package.json   # 后端依赖配置
├── tsconfig.json          # TypeScript配置
├── vite.config.ts         # Vite配置
├── tailwind.config.js     # Tailwind配置
├── README.md              # 项目说明
├── .gitignore             # Git忽略文件
└── 项目分享指南.md         # 本指南
```

#### 必须排除的文件和文件夹：

```
❌ 必须排除：
├── node_modules/          # 依赖包（太大，可重新安装）
├── backend/node_modules/  # 后端依赖包
├── .env                   # 环境变量（包含敏感信息）
├── backend/.env           # 后端环境变量
├── dist/                  # 构建产物
├── backend/dist/          # 后端构建产物
├── coverage/              # 测试覆盖率报告
├── uploads/               # 上传文件（可能很大）
├── backend/uploads/       # 后端上传文件
├── logs/                  # 日志文件
├── *.log                  # 各种日志文件
├── *.pem                  # SSL证书文件
├── .vscode/               # 编辑器配置
├── .idea/                 # IDE配置
└── *.tsbuildinfo          # TypeScript构建信息
```

## 📋 接收方项目设置指南

### 1. 环境准备

```bash
# 确保安装了Node.js (版本22.17.1或更高)
node --version
npm --version

# 确保安装了MySQL (版本8.0或更高)
mysql --version
```

### 2. 创建环境变量文件

**前端环境变量 (.env)：**
```env
# 前端环境变量（根据实际情况修改）
VITE_API_BASE_URL=http://localhost:3001/api/v1
VITE_APP_NAME=水晶ERP系统
```

**后端环境变量 (backend/.env)：**
```env
# 数据库配置（请修改为您的数据库信息）
DATABASE_URL="mysql://root:your_password@localhost:3306/crystal_erp_dev"

# 服务器配置
PORT=3001
NODE_ENV=development

# JWT配置
JWT_SECRET=your_jwt_secret_key_here
JWT_EXPIRES_IN=7d

# 豆包AI服务配置（可选）
DOUBAO_API_KEY="your_doubao_api_key"
DOUBAO_BASE_URL="https://ark.cn-beijing.volces.com/api/v3"
DOUBAO_MODEL="doubao-1.5-pro-32k-250115"

# 文件上传配置
UPLOAD_PATH=./uploads
MAX_FILE_SIZE=5242880

# 网络配置
LOCAL_IP=auto
CORS_ORIGIN=*

# 日志配置
LOG_LEVEL=info
LOG_FILE=./logs/app.log
```

### 3. 数据库设置

```bash
# 1. 创建数据库
mysql -u root -p
CREATE DATABASE crystal_erp_dev CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci;
EXIT;

# 2. 进入后端目录
cd backend

# 3. 生成Prisma客户端
npm run db:generate

# 4. 推送数据库模型
npm run db:push

# 5. 运行数据库种子（创建测试数据）
npm run db:seed
```

### 4. 启动项目

```bash
# 1. 启动后端服务（在backend目录下）
cd backend
npm run dev
# 后端将在 http://localhost:3001 启动

# 2. 启动前端服务（在项目根目录下）
cd ..
npm run dev
# 前端将在 http://localhost:5173 启动
```

### 5. 验证安装

1. **访问前端页面：** http://localhost:5173
2. **测试登录：**
   - 用户名：`boss` 密码：`123456` （管理员）
   - 用户名：`employee` 密码：`123456` （员工）
3. **检查API：** http://localhost:3001/api/v1/health

## 🔧 常见问题解决

### 问题1：npm install失败
```bash
# 清除npm缓存
npm cache clean --force

# 删除package-lock.json后重新安装
rm package-lock.json
npm install
```

### 问题2：数据库连接失败
- 检查MySQL服务是否启动
- 确认数据库用户名、密码、端口是否正确
- 确认数据库已创建

### 问题3：端口被占用
```bash
# 查看端口占用情况
netstat -ano | findstr :3001
netstat -ano | findstr :5173

# 修改端口（在.env文件中）
PORT=3002  # 后端端口
# 前端端口在vite.config.ts中修改
```

### 问题4：权限错误
```bash
# Windows下以管理员身份运行命令行
# Mac/Linux下使用sudo（谨慎使用）
sudo npm install
```

## 📱 手机端测试配置

如果需要在手机上测试：

1. **确保电脑和手机在同一WiFi网络**
2. **获取电脑IP地址：**
   ```bash
   # Windows
   ipconfig
   
   # Mac/Linux
   ifconfig
   ```
3. **手机访问：** `http://你的电脑IP:5173`

## 🚀 生产环境部署

如需部署到服务器，请参考项目文档：
- `.trae/documents/08-部署运维规范文档.md`
- 包含阿里云、宝塔面板等部署指南

## 📞 技术支持

如果在设置过程中遇到问题：
1. 查看项目文档（`.trae/documents/`目录）
2. 检查控制台错误信息
3. 确认环境变量配置正确
4. 联系项目维护者

---

**重要提醒：**
- 生产环境请修改默认密码
- 不要在公网暴露开发环境
- 定期备份数据库
- 保护好.env文件中的敏感信息