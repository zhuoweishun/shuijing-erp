## 文档 12：客户标签定义与分类规范文档

### 一、客户标签体系概述

本文档定义了水晶ERP系统中的客户标签分类体系，包括基础分类、活跃度分类、价值分类和行为分类四个维度，共12个客户标签。这些标签用于客户分析、营销策略制定和客户关系管理。

### 二、基础分类标签

#### 2.1 新客（NEW）
**定义：** 首次购买的客户
**计算逻辑：** `total_orders === 1`
**业务意义：** 新获取的客户，需要重点关注和培养
**营销策略：** 提供优质服务，建立良好第一印象

#### 2.2 复购（REPEAT）
**定义：** 购买2次以上的客户
**计算逻辑：** `total_orders >= 2`
**业务意义：** 已建立信任关系的客户，具有较高忠诚度
**营销策略：** 维护关系，推荐相关产品

#### 2.3 狂热（FANATIC）
**定义：** 购买次数前20%的客户
**计算逻辑：** 
```typescript
const total_orders_list = customers.map(c => c.total_orders).sort((a, b) => b - a)
const fanatic_count = Math.ceil(total_orders_list.length * 0.2)
const fanatic_index = Math.max(0, fanatic_count - 1)
const fanatic_threshold = total_orders_list[fanatic_index]
const fanatic_customers = customers.filter(c => c.total_orders >= fanatic_threshold)
```
**业务意义：** 最活跃的客户群体，是品牌的忠实拥护者
**营销策略：** 提供VIP服务，邀请参与新品试用

#### 2.4 VIP（VIP）
**定义：** 消费金额前20%的客户
**计算逻辑：**
```typescript
const total_purchases_list = customers.map(c => c.total_purchases).sort((a, b) => b - a)
const vip_count = Math.ceil(total_purchases_list.length * 0.2)
const vip_index = Math.max(0, vip_count - 1)
const vip_threshold = total_purchases_list[vip_index]
const vip_customers = customers.filter(c => c.total_purchases >= vip_threshold)
```
**业务意义：** 高价值客户，对收入贡献最大
**营销策略：** 专属服务，优先推荐高端产品

### 三、活跃度分类标签

**计算方式说明：** 活跃度标签基于固定天数阈值计算，不使用动态四分位数算法，确保标签定义的稳定性和可预测性。

#### 3.1 渐退（DECLINING）
**定义：** 31-90天没有购买行为的客户
**计算逻辑：**
```typescript
if (customer.last_purchase_date) {
  const lastPurchase = new Date(customer.last_purchase_date)
  const now = new Date()
  const daysSinceLastPurchase = Math.floor((now.getTime() - lastPurchase.getTime()) / (1000 * 60 * 60 * 24))
  
  if (daysSinceLastPurchase >= 31 && daysSinceLastPurchase <= 90) {
    labels.push('DECLINING')
  }
}
```
**业务意义：** 活跃度开始下降，需要关注
**营销策略：** 主动联系，了解需求变化

#### 3.2 冷静（COOLING）
**定义：** 91-180天没有购买行为的客户
**计算逻辑：**
```typescript
if (customer.last_purchase_date) {
  const lastPurchase = new Date(customer.last_purchase_date)
  const now = new Date()
  const daysSinceLastPurchase = Math.floor((now.getTime() - lastPurchase.getTime()) / (1000 * 60 * 60 * 24))
  
  if (daysSinceLastPurchase >= 91 && daysSinceLastPurchase <= 180) {
    labels.push('COOLING')
  }
}
```
**业务意义：** 购买意愿明显降低，需要激活
**营销策略：** 发送优惠信息，推荐新品

#### 3.3 沉默（SILENT）
**定义：** 181-365天没有购买行为的客户
**计算逻辑：**
```typescript
if (customer.last_purchase_date) {
  const lastPurchase = new Date(customer.last_purchase_date)
  const now = new Date()
  const daysSinceLastPurchase = Math.floor((now.getTime() - lastPurchase.getTime()) / (1000 * 60 * 60 * 24))
  
  if (daysSinceLastPurchase >= 181 && daysSinceLastPurchase <= 365) {
    labels.push('SILENT')
  }
}
```
**业务意义：** 长期未购买，流失风险较高
**营销策略：** 重新激活活动，特别优惠

#### 3.4 流失（LOST）
**定义：** 366天以上没有购买行为的客户
**计算逻辑：**
```typescript
if (customer.last_purchase_date) {
  const lastPurchase = new Date(customer.last_purchase_date)
  const now = new Date()
  const daysSinceLastPurchase = Math.floor((now.getTime() - lastPurchase.getTime()) / (1000 * 60 * 60 * 24))
  
  if (daysSinceLastPurchase >= 366) {
    labels.push('LOST')
  }
}
```
**业务意义：** 已基本流失的客户
**营销策略：** 挽回活动，了解流失原因

### 四、价值分类标签

#### 4.1 高客（HIGH_VALUE）
**定义：** 客单价最高的前20%的客户
**计算逻辑：**
```typescript
const valid_customers = customers.filter(c => c.total_orders > 0)
const avg_order_values = valid_customers.map(c => c.total_purchases / c.total_orders).sort((a, b) => b - a)
const high_value_count = Math.ceil(avg_order_values.length * 0.2)
const high_value_index = Math.max(0, high_value_count - 1)
const high_value_threshold = avg_order_values[high_value_index]
const high_value_customers = valid_customers.filter(c => {
  const avg_order_value = c.total_purchases / c.total_orders
  return avg_order_value >= high_value_threshold
})
```
**业务意义：** 单次消费金额高，价值密度大
**营销策略：** 推荐高端产品，提供定制服务

#### 4.2 低客（LOW_VALUE）
**定义：** 客单价最低的20%的客户
**计算逻辑：**
```typescript
const valid_customers = customers.filter(c => c.total_orders > 0)
const avg_order_values = valid_customers.map(c => c.total_purchases / c.total_orders).sort((a, b) => a - b)
const low_value_count = Math.ceil(avg_order_values.length * 0.2)
const low_value_index = Math.max(0, low_value_count - 1)
const low_value_threshold = avg_order_values[low_value_index]
const low_value_customers = valid_customers.filter(c => {
  const avg_order_value = c.total_purchases / c.total_orders
  return avg_order_value <= low_value_threshold
})
```
**业务意义：** 单次消费金额低，价格敏感
**营销策略：** 推荐性价比产品，提供优惠

### 五、行为分类标签

#### 5.1 挑剔（PICKY）
**定义：** 退货次数最多的前20%的客户
**计算逻辑：**
```typescript
const refund_counts = customers.map(c => c.refund_count || 0).sort((a, b) => b - a)
const picky_count = Math.ceil(refund_counts.length * 0.2)
const picky_index = Math.max(0, picky_count - 1)
const picky_threshold = refund_counts[picky_index]
const picky_customers = customers.filter(c => (c.refund_count || 0) >= picky_threshold)
```
**业务意义：** 对产品要求较高，退货频繁
**营销策略：** 提供详细产品信息，确保质量

#### 5.2 刺客（ASSASSIN）
**定义：** 退货率最高的前20%的客户
**计算逻辑：**
```typescript
const refund_rates = customers.map(c => {
  const refund_rate = c.total_orders > 0 ? (c.refund_count || 0) / c.total_orders : 0
  return refund_rate
}).sort((a, b) => b - a)
const assassin_count = Math.ceil(refund_rates.length * 0.2)
const assassin_index = Math.max(0, assassin_count - 1)
const assassin_threshold = refund_rates[assassin_index]
const assassin_customers = customers.filter(c => {
  const refund_rate = c.total_orders > 0 ? (c.refund_count || 0) / c.total_orders : 0
  return refund_rate >= assassin_threshold
})
```
**业务意义：** 退货比例高，可能影响利润
**营销策略：** 谨慎服务，重点关注售后

### 六、标签应用场景

#### 6.1 客户分析
- **客户画像构建**：基于多维度标签描述客户特征
- **客户价值评估**：结合VIP、高客等标签评估客户价值
- **客户生命周期管理**：通过活跃度标签跟踪客户状态

#### 6.2 营销策略
- **精准营销**：针对不同标签客户制定差异化策略
- **客户挽回**：重点关注沉默、流失客户的激活
- **价值提升**：引导新客向复购、狂热客户转化

#### 6.3 运营决策
- **资源配置**：优先服务VIP、狂热等高价值客户
- **产品推荐**：基于客户标签推荐合适产品
- **风险控制**：关注挑剔、刺客客户的服务质量

### 七、技术实现规范

#### 7.1 数据字段要求
客户标签计算需要以下数据字段：
- `total_orders`：有效订单次数（不包含退货）
- `total_purchases`：有效消费金额（不包含退货金额）
- `last_purchase_date`：最后购买时间
- `refund_count`：退货次数
- `refund_rate`：退货率（退货次数/总订单次数）

**特殊情况处理：**
- 单客户情况：当系统中只有一个客户时，该客户会被标记为所有适用的标签（如低客、高客等）
- 空值处理：`refund_count`和`refund_rate`为空时默认为0
- 无购买记录：`total_orders`为0的客户不参与客单价相关标签计算

#### 7.2 计算频率
- **实时计算**：新客、复购标签在交易发生时实时更新
- **定期计算**：其他标签建议每日凌晨批量计算更新
- **手动触发**：支持管理员手动触发标签重新计算

#### 7.3 性能优化
- **缓存机制**：计算结果缓存，避免重复计算
- **分页处理**：大量客户数据分批处理
- **索引优化**：相关字段建立数据库索引

### 八、标签展示规范

#### 8.1 前端展示
- **颜色编码**：不同类型标签使用不同颜色区分
- **图标设计**：每个标签配备专属图标
- **排序规则**：按标签重要性和业务价值排序

#### 8.2 API接口
- **筛选参数**：支持按标签类型筛选客户
- **批量查询**：支持同时查询多个标签的客户
- **统计接口**：提供各标签客户数量统计

### 九、数据质量保证

#### 9.1 数据验证
- **字段完整性**：确保计算所需字段数据完整
- **数据准确性**：定期校验计算结果的准确性
- **异常处理**：处理空值、异常值等特殊情况

#### 9.2 监控告警
- **计算异常**：标签计算失败时发送告警
- **数据异常**：标签分布异常时提醒检查
- **性能监控**：监控标签计算的性能指标

### 十、版本更新记录

| 版本号 | 更新日期 | 更新内容 | 更新人员 |
|--------|----------|----------|----------|
| 1.0.0  | 2025-01-27 | 初始版本，定义12个客户标签 | 系统管理员 |
| 1.1.0  | 2025-01-27 | 修正活跃度标签计算方式为固定天数阈值，更新数据字段要求，添加特殊情况处理说明 | 系统管理员 |

### 十一、相关文档引用

- 《业务流程详细规范文档》第13.4节：客户分类统计
- 《API接口统一规范文档》第7节：客户管理接口
- 《React前端开发规范文档》第9.5节：客户分析卡片组件
- 《文档总览与查询索引》第二节：术语对照表