# 手机端连接问题解决方案

## 问题描述
手机端显示"手机端网络请求失败，请检查网络连接或尝试切换网络"，无法登录系统。

## 根本原因
Windows防火墙阻止了3001端口的入站连接，导致手机无法访问后端API服务。

## 解决方案

### 方案一：通过Windows防火墙设置（推荐）

1. **打开Windows防火墙设置**
   - 按 `Win + R` 键，输入 `wf.msc`，按回车
   - 或者：控制面板 → 系统和安全 → Windows Defender防火墙 → 高级设置

2. **添加入站规则**
   - 在左侧点击"入站规则"
   - 在右侧点击"新建规则..."
   - 选择"端口" → 下一步
   - 选择"TCP" → 特定本地端口 → 输入 `3001` → 下一步
   - 选择"允许连接" → 下一步
   - 勾选所有配置文件（域、专用、公用） → 下一步
   - 名称输入：`水晶ERP后端API` → 完成

### 方案二：通过命令行（需要管理员权限）

1. **以管理员身份运行PowerShell**
   - 右键点击开始菜单
   - 选择"Windows PowerShell (管理员)"

2. **执行命令**
   ```powershell
   netsh advfirewall firewall add rule name="水晶ERP后端API" dir=in action=allow protocol=TCP localport=3001
   ```

### 方案三：临时关闭防火墙（不推荐，仅用于测试）

1. **打开Windows防火墙设置**
   - 控制面板 → 系统和安全 → Windows Defender防火墙

2. **关闭防火墙**
   - 点击"启用或关闭Windows Defender防火墙"
   - 临时关闭专用网络和公用网络的防火墙
   - **注意：测试完成后请重新启用防火墙**

## 验证解决方案

1. **检查端口是否开放**
   ```cmd
   netstat -an | findstr :3001
   ```
   应该看到：`TCP    0.0.0.0:3001           0.0.0.0:0              LISTENING`

2. **使用网络测试功能**
   - 在登录页面点击"网络测试"按钮
   - 查看测试结果，确认API连接正常

3. **手机端测试**
   - 确保手机和电脑在同一WiFi网络
   - 用手机访问：`http://192.168.50.160:5173/login`
   - 尝试登录，应该能正常工作

## 其他可能的问题

### 1. 网络配置问题
- 确认手机和电脑在同一WiFi网络
- 检查路由器是否启用了AP隔离
- 尝试重启路由器

### 2. IP地址变化
- 如果电脑IP地址发生变化，需要用新IP访问
- 可以在电脑上运行 `ipconfig` 查看当前IP

### 3. 杀毒软件干扰
- 某些杀毒软件可能阻止网络连接
- 临时关闭杀毒软件进行测试

### 4. 代理或VPN
- 检查手机是否设置了代理或VPN
- 临时关闭代理/VPN进行测试

## 技术说明

- **后端服务器**：已正确配置为监听 `0.0.0.0:3001`（所有网络接口）
- **CORS配置**：已正确配置，允许跨域请求
- **网络测试功能**：登录页面集成了自动网络诊断功能
- **设备检测**：已修复，能正确识别手机端

## 联系支持

如果以上方案都无法解决问题，请提供以下信息：
1. 网络测试结果截图
2. 浏览器控制台错误信息
3. 网络环境描述（路由器型号、网络配置等）